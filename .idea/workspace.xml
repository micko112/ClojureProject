<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="AutoImportSettings">
    <option name="autoReloadType" value="SELECTIVE" />
  </component>
  <component name="ChangeListManager">
    <list default="true" id="4d338447-6f3a-43e8-ab8c-95e214f36644" name="Changes" comment="User can choose activity, intensity, duration and remove activity">
      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/.nrepl-port" beforeDir="false" afterPath="$PROJECT_DIR$/.nrepl-port" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/src/web/server.clj" beforeDir="false" afterPath="$PROJECT_DIR$/src/web/server.clj" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/target/classes/META-INF/maven/ProjectV1/ProjectV1/pom.properties" beforeDir="false" afterPath="$PROJECT_DIR$/target/classes/META-INF/maven/ProjectV1/ProjectV1/pom.properties" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/target/repl-port" beforeDir="false" afterPath="$PROJECT_DIR$/target/repl-port" afterDir="false" />
    </list>
    <option name="SHOW_DIALOG" value="false" />
    <option name="HIGHLIGHT_CONFLICTS" value="true" />
    <option name="HIGHLIGHT_NON_ACTIVE_CHANGELIST" value="false" />
    <option name="LAST_RESOLUTION" value="IGNORE" />
  </component>
  <component name="FileTemplateManagerImpl">
    <option name="RECENT_TEMPLATES">
      <list>
        <option value="Clojure Test Namespace" />
        <option value="Clojure Namespace" />
      </list>
    </option>
  </component>
  <component name="Git.Settings">
    <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
  </component>
  <component name="GitHubPullRequestSearchHistory">{
  &quot;lastFilter&quot;: {
    &quot;state&quot;: &quot;OPEN&quot;,
    &quot;assignee&quot;: &quot;micko112&quot;
  }
}</component>
  <component name="GithubPullRequestsUISettings">{
  &quot;selectedUrlAndAccountId&quot;: {
    &quot;url&quot;: &quot;https://github.com/micko112/ClojureProject.git&quot;,
    &quot;accountId&quot;: &quot;3764571a-842a-40c7-838d-20632f3769b4&quot;
  }
}</component>
  <component name="HighlightingSettingsPerFile">
    <setting file="file://$PROJECT_DIR$/src/project/db.clj" root0="FORCE_HIGHLIGHTING" />
  </component>
  <component name="ProjectColorInfo">{
  &quot;associatedIndex&quot;: 5
}</component>
  <component name="ProjectId" id="37ZsZpPnuy4tgd50LQGXH7cfGlR" />
  <component name="ProjectViewState">
    <option name="hideEmptyMiddlePackages" value="true" />
    <option name="showLibraryContents" value="true" />
  </component>
  <component name="PropertiesComponent">{
  &quot;keyToString&quot;: {
    &quot;Clojure REPL.REPL for ProjectV1.executor&quot;: &quot;Run&quot;,
    &quot;ModuleVcsDetector.initialDetectionPerformed&quot;: &quot;true&quot;,
    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,
    &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;,
    &quot;SHARE_PROJECT_CONFIGURATION_FILES&quot;: &quot;true&quot;,
    &quot;clojure.test.Test project.api-test/delta-test.executor&quot;: &quot;Run&quot;,
    &quot;clojure.test.Test project.api-test/leaderboard-rank-ties-test.executor&quot;: &quot;Run&quot;,
    &quot;cursive.last.file.extension.C\\:/xampp/htdocs/Clojure/Clojure for Brave and True/ProjectV1/src&quot;: &quot;clj&quot;,
    &quot;cursive.last.file.extension.C\\:/xampp/htdocs/Clojure/Clojure for Brave and True/ProjectV1/test&quot;: &quot;clj&quot;,
    &quot;git-widget-placeholder&quot;: &quot;main&quot;,
    &quot;last_opened_file_path&quot;: &quot;C:/xampp/htdocs/Clojure/Clojure for Brave and True/ProjectV1/project.clj&quot;,
    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,
    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,
    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,
    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,
    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,
    &quot;settings.editor.selected.configurable&quot;: &quot;preferences.lookFeel&quot;,
    &quot;vue.rearranger.settings.migration&quot;: &quot;true&quot;
  },
  &quot;keyToStringList&quot;: {
    &quot;GitStage.ChangesTree.GroupingKeys&quot;: [
      &quot;directory&quot;,
      &quot;module&quot;,
      &quot;repository&quot;
    ]
  }
}</component>
  <component name="RecentsManager">
    <key name="MoveFile.RECENT_KEYS">
      <recent name="C:\xampp\htdocs\Clojure\Clojure for Brave and True\ProjectV1\src\playground" />
    </key>
  </component>
  <component name="ReplState" timestamp="1769867348031">{:repl-history {:ide [], :local [{:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot;  :hx-target \&quot;#activity-result\&quot;\n                              :hx-change \&quot;change\&quot; :hx-sync \&quot;closest form:abort\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot;  :hx-target \&quot;#activity-result\&quot;\n                                 :hx-change \&quot;change\&quot; :hx-sync \&quot;closest form:abort\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n              [:div#activity-result]\n             ])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params \&quot;title\&quot;])\n        duration (get-in request [:params \&quot;duration\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                                   ])\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4909, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot;  :hx-target \&quot;#activity-result\&quot;\n                              :hx-change \&quot;change\&quot; }]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot;  :hx-target \&quot;#activity-result\&quot;\n                                 :hx-change \&quot;change\&quot; }]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n              [:div#activity-result]\n             ])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params \&quot;title\&quot;])\n        duration (get-in request [:params \&quot;duration\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                                   ])\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4851, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n              [:div#activity-result]\n             ])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params \&quot;title\&quot;])\n        duration (get-in request [:params \&quot;duration\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                                   ])\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4729, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n              [:div#activity-result]\n             ])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params \&quot;title\&quot;])\n        duration (get-in request [:params \&quot;duration\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                                   ])\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4750, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n              \n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params \&quot;title\&quot;])\n        duration (get-in request [:params \&quot;duration\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                                   ])\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4764, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4785, :ns &quot;project.core&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      (into [:&lt;&gt;] content ) ]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4858, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4822, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4824, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 4956, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5293, :ns &quot;project.core&quot;} {:command &quot;[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]&quot;, :offset 216, :ns &quot;web.server&quot;} {:command &quot;(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])&quot;, :offset 54, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              [day-column nil]\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:param \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6017, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:param \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6017, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:param \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6264, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       { margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6265, :ns &quot;project.core&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       margin: 0; padding: 0; box-sizing: border-box;\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-bar {:class \&quot;sidebar\&quot;}\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6276, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       margin: 0; padding: 0; box-sizing: border-box; }\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6263, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex, gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6269, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{ \\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot; }\&quot;)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params \&quot;day\&quot;])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 (day-column day) )})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6269, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-params (str \&quot;day=\&quot; d)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params :day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (day-column day)})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6245, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))&quot;, :offset 553, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-params (str \&quot;day=\&quot; d)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params :day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html(day-column day))})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/klik\&quot; {:post click-handler}]\n                  [\&quot;/title\&quot; {:post title-handler}]\n                  [\&quot;/duration\&quot; {:post duration-handler}]\n                  [\&quot;/activity\&quot; {:post activity-handler}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler)))\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6288, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))&quot;, :offset 613, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-params (str \&quot;day=\&quot; d)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params :day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html(day-column day))})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    wrap-session\n    (ring/create-default-handler)))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6151, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-params (str \&quot;day=\&quot; d)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params :day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html(day-column day))})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    \n    (ring/create-default-handler)))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6139, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       head { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-params (str \&quot;day=\&quot; d)\n       :hx-target \&quot;#days-container\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n\n[:div.calendar\n [:div.day-column\n  {:style \&quot;position: relative; height: 1440px;\&quot;}\n  (for [hour (range 24)]\n    [:div.hour-line\n     {:style (str \&quot;position: absolute; top: \&quot; (* hour 60) \&quot;px;\&quot;)}\n     (str hour \&quot;:00\&quot;)])]]\n(defn calendar [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 (\n\n            ))})\n(defn home-page [request]\n\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column nil)\n\n              [:div \&quot;Nista se ne desava\&quot;\n              [:button {:hx-post \&quot;/klik\&quot;\n                        :hx-target \&quot;this\&quot;\n                        :hx-swap \&quot;innerHTML\&quot;\n                        :hx-indicator \&quot;.spinner\&quot;\n                      }\n               [:span.btn-text \&quot;BUTTON\&quot;]\n               [:span.spinner.htmx-indicator\n                {:style \&quot;margin-left:10px\&quot;}\n                \&quot;Loading...\&quot;]]\n              ]\n              [:form {:hx-post \&quot;/activity\&quot; :hx-target \&quot;#activity-result\&quot; :hx-trigger \&quot;submit\&quot;}\n               [:input#title {:name \&quot;title\&quot; :type \&quot;text\&quot; :placeholder \&quot;Title\&quot;}]\n               [:input#duration {:name \&quot;duration\&quot; :type \&quot;text\&quot; :placeholder \&quot;Duration\&quot;}]\n               [:button {:type \&quot;submit\&quot;} \&quot;Submit\&quot;]]\n             ]\n             [:div#activity-result])\n           })\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params :day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html(day-column day))})\n  )\n(defn click-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n   (html5 [:p {:style \&quot;color: blue; font-weight: bold;\&quot;}\n    \&quot;click done\&quot;])\n   })\n\n(def app\n  (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (wrap-session (ring/create-default-handler))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 6149, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style \&quot;position:absolute; top:\\\&quot; (* hour 60) \\\&quot;px;\&quot;}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             [:div#activity-result])\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [request]\n  (let [day (get-in request [:params :day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html(day-column day)))})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5378, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style \&quot;position:absolute; top:\\\&quot; (* hour 60) \\\&quot;px;\&quot;}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             [:div#activity-result])\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html(day-column day)))})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}})\n    (ring/create-default-handler))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.close s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5423, :ns &quot;web.server&quot;} {:command &quot;(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))&quot;, :offset 128, :ns &quot;web.server&quot;} {:command &quot;(stop-server)&quot;, :offset 1, :ns &quot;web.server&quot;} {:command &quot;(def app\n  (wrap-session\n    (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}}))))&quot;, :offset 344, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             [:div#activity-result])\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html(day-column day)))})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n    (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}}))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5396, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#day-column\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             [:div#activity-result])\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html(day-column day)))})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n    (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}}))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5398, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             [:div#activity-result])\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (h/html [:div#calendar\n                    (calendar day)])})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n    (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}}))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5425, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             [:div#activity-result])\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (h/html (calendar day))})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n    (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}}))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5389, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n  (:require [ring.adapter.jetty :as jetty]\n            [reitit.ring :as ring]\n            [reitit.ring.middleware.parameters :as parameters]\n            [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n            [hiccup.page :refer [html5]]\n            [hiccup2.core :as h]\n            [project.api :as api]\n            [datomic.api :as d]\n            [project.system :as sys]\n            [clojure.string :as str]\n            [ring.middleware.session :refer [wrap-session]])\n  (:import (java.time LocalDate LocalTime Duration ZoneId)\n           (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n   (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n    [:head\n     [:title \&quot;BeBetter\&quot;]\n     [:meta {:charset \&quot;UTF-8\&quot;}]\n     [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n     [:style \&quot;\n       * { margin: 0; padding: 0; box-sizing: border-box;}\n      body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n      .header { background: #2c3e50; color: white; padding: 1rem; }\n      .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n      .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n      .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n      .nav a:hover { text-decoration: underline; }\n      .htmx-indicator { display: none; }\n      .htmx-request .htmx-indicator { display: inline-block; }\n      .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n      .day-column:hover {background: #f0f0f0;}\n      .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n    [:body\n     [:nav-sidebar\n      [:div.logo \&quot;BeBetter\&quot;]\n      [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n     [:main.main-content\n      content]\n     [:footer.footer\n      [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n    ))\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-container\&quot;\n         :style \&quot;display: flex; gap: 1rem;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d]\n     )]\n  )\n(defn calendar [day]\n  [:div.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]\n   ]\n  )\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body\n           (common-layout\n             [:div\n              [:h2 \&quot;Calendar\&quot;]\n              (day-column selected-day)\n              [:div#calendar\n               (calendar selected-day)]\n             ]\n             )\n           }))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n    :body\n    (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n     })\n  )\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar day)))})\n  )\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n    (ring/ring-handler\n    (ring/router [\n                  [\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params\n                                      ]}}))))\n\n\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 5373, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n  (def port 3000)\n  (defn parse-date [date-str]\n    (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n      (LocalDate/now)\n      (try (LocalDate/parse date-str)\n           (catch Exception _ (LocalDate/now)))))\n\n  (defn format-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n  (defn nice-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n  (defn get-next-day [date]\n     (.plusDays date 1))\n  (defn get-previous-day [date]\n    (.minusDays date 1))\n\n  (defn insant-&gt;minutes-from-midnight [inst]\n    (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n          hour (.getHour zdt)\n          minute (.getMinute zdt)\n          (+ (* hour 60) minute)]))\n\n  (defn common-layout [&amp; content]\n    (html5\n      [:head\n       [:title \&quot;BeBetter\&quot;]\n       [:meta {:charset \&quot;UTF-8\&quot;}]\n       [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n       [:style \&quot;\n         * { margin: 0; padding: 0; box-sizing: border-box;}\n        body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n        .header { background: #2c3e50; color: white; padding: 1rem; }\n        .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n        .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n        .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n        .nav a:hover { text-decoration: underline; }\n        .htmx-indicator { display: none; }\n        .htmx-request .htmx-indicator { display: inline-block; }\n        .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n        .day-column:hover {background: #f0f0f0;}\n        .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\&quot;]]\n      [:body\n       [:nav-sidebar\n        [:div.logo \&quot;BeBetter\&quot;]\n        [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n       [:main.main-content\n        content]\n       [:footer.footer\n        [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n      ))\n  (def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n  (defn day-column [selected-day]\n    [:div {:id \&quot;days-nav\&quot;\n           :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n     (for [d days]\n       [:div.day-column\n        {:class (when (= d selected-day) \&quot;selected\&quot;)\n         :hx-post \&quot;/select-day\&quot;\n         :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n         :hx-target \&quot;#calendar-view\&quot;\n         :hx-swap \&quot;outerHTML\&quot;}\n        d]\n       )]\n    )\n  (defn calendar-view [day]\n    [:div#calendar-view.calendar\n     [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n     [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n      (for [hour (range 24)]\n        [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n         (str hour \&quot;:00\&quot;)])]\n     ]\n    )\n\n  (defn home-page [{:keys [session]}]\n    (let [selected-day (:select-day session)] {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n             (common-layout\n               [:div\n                [:h2 \&quot;Calendar\&quot;]\n                (day-column selected-day)\n                (calendar-view selected-day)\n               ]\n               )\n             }))\n\n  (defn title-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Title updated\&quot;])})\n\n  (defn duration-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n  (defn activity-handler [request]\n    (let [title (get-in request [:params :title])\n          duration (get-in request [:params :duration])]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n      :body\n      (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n       })\n    )\n  (defn select-day-handler [{:keys [params session]}]\n    (let [day (:day params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :session (assoc session :select-day day)\n       :body (str (h/html (calendar-view day))\n                  (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                           (h/html (day-column day))]))})\n    )\n  (defn dummy-handler [request]\n    {:status 200 :body \&quot;OK\&quot;})\n\n  (def app\n    (wrap-session\n      (ring/ring-handler\n      (ring/router [\n                    [\&quot;/\&quot; {:get home-page}]\n                    [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                   {:data {:middleware [parameters/parameters-middleware\n                                        wrap-keyword-params\n                                        ]}}))))\n\n\n\n  (defonce server (atom nil))\n\n  (defn start-server []\n    (when-not @server\n      (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n      (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.stop s)\n      (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.interrupt s)\n      (reset! server nil)))&quot;, :offset 5802, :ns &quot;project.core&quot;} {:command &quot;(defn sidebar []\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:span \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:a.nav-link\n       [:li [:span \&quot;Activity\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Feed\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Leaderboard\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Search\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;My Profile\&quot;]]]\n\n      ]])&quot;, :offset 377, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n  (def port 3000)\n  (defn parse-date [date-str]\n    (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n      (LocalDate/now)\n      (try (LocalDate/parse date-str)\n           (catch Exception _ (LocalDate/now)))))\n\n  (defn format-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n  (defn nice-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n  (defn get-next-day [date]\n     (.plusDays date 1))\n  (defn get-previous-day [date]\n    (.minusDays date 1))\n\n  (defn insant-&gt;minutes-from-midnight [inst]\n    (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n          hour (.getHour zdt)\n          minute (.getMinute zdt)\n          (+ (* hour 60) minute)]))\n\n  (defn common-layout [&amp; content]\n    (html5\n      [:head\n       [:title \&quot;BeBetter\&quot;]\n       [:meta {:charset \&quot;UTF-8\&quot;}]\n       [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n       [:style \&quot;\n         * { margin: 0; padding: 0; box-sizing: border-box;}\n        body { font-family: sans-serif; min-height: 100vh; display: flex; flex-direction: column; }\n        .header { background: #2c3e50; color: white; padding: 1rem; }\n        .main { flex: 1; padding: 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }\n        .footer { background: #34495e; color: white; padding: 1rem; text-align: center; }\n        .nav a { color: white; margin-right: 1rem; text-decoration: none; }\n        .nav a:hover { text-decoration: underline; }\n        .htmx-indicator { display: none; }\n        .htmx-request .htmx-indicator { display: inline-block; }\n        .day-column {\\n  border: 1px solid #ccc; padding: 1rem;\\n  cursor: pointer;  transition: background 0.2s;}\n        .day-column:hover {background: #f0f0f0;}\n        .day-column.selected {background: #2c3e50; color: white; border-color: #2c3e50;}\n        .sidebar {  width: 245px;  background-color: #ffffff;  padding-top: 35px;  position: fixed;  height: 100vh;\n        top: 0;  left: 0;  z-index: 999;  border-right: 1px solid rgb(var(--ig-separator));  display: flex;  flex-direction: column;\n        .logo-wrapper { width: 100%; padding: 5px 25px; margin-bottom: 20px;}\n        .logo-wrapper img {  width: 105px;}\n        .sidebar-menu {font-size: 1rem; list-style-type: none; padding 0 12px 20px 8px; ; margin 0; display: flex; flex-direction: column; flex-grow: 3; }\n        .sidebar-menu.bottom {  flex-grow: 0;  margin-bottom: 40px;}\n        .sidebar-menu li {  /*margin-bottom: 10px;*/}\n        .sidebar-menu li a.nav.link {border.radius: 15px; padding: 16px 15px; color: #333333; text-decoration: none; display:flex; align-items: center;}\n        .sidebar-menu li a.nav-link.active { font-weight: bold;}\n        .sidebar-menu li a.nav-link.active img.icon { border: 2px solid black;}\n        .sidebar-menu li a.nav-link .icon { margin-right: 15px; width: 24px; height: 24px; transition: all 0.2s ease-in-out;}\n        .sidebar-menu li a.nav-link:hover { background-color: #f5f5f5;}\n        .sidebar-menu li a.nav-link:hover .icon { transform: scale(1.08);}\n        .rounded-circle  {border-radius: 100%;}\n\n        \&quot;]]\n      [:body\n       [:sidebar\n        [:div.logo \&quot;BeBetter\&quot;]\n        [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n       [:main.main-content\n        content]\n       [:footer.footer\n        [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n      ))\n  (defn sidebar []\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:span \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:a.nav-link\n       [:li [:span \&quot;Activity\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Feed\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Leaderboard\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Search\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;My Profile\&quot;]]]\n\n      ]])\n\n\n  (def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n  (defn day-column [selected-day]\n    [:div {:id \&quot;days-nav\&quot;\n           :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n     (for [d days]\n       [:div.day-column\n        {:class (when (= d selected-day) \&quot;selected\&quot;)\n         :hx-post \&quot;/select-day\&quot;\n         :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n         :hx-target \&quot;#calendar-view\&quot;\n         :hx-swap \&quot;outerHTML\&quot;}\n        d]\n       )]\n    )\n  (defn calendar-view [day]\n    [:div#calendar-view.calendar\n     [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n     [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n      (for [hour (range 24)]\n        [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n         (str hour \&quot;:00\&quot;)])]\n     ]\n    )\n\n  (defn home-page [{:keys [session]}]\n    (let [selected-day (:select-day session)] {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n             (common-layout\n               [:div\n                (sidebar )]\n               [:div\n                [:h2 \&quot;Calendar\&quot;]\n                (day-column selected-day)\n                (calendar-view selected-day)\n               ]\n               )\n             }))\n\n  (defn title-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Title updated\&quot;])})\n\n  (defn duration-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n  (defn activity-handler [request]\n    (let [title (get-in request [:params :title])\n          duration (get-in request [:params :duration])]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n      :body\n      (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n       })\n    )\n  (defn select-day-handler [{:keys [params session]}]\n    (let [day (:day params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :session (assoc session :select-day day)\n       :body (str (h/html (calendar-view day))\n                  (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                           (h/html (day-column day))]))})\n    )\n  (defn dummy-handler [request]\n    {:status 200 :body \&quot;OK\&quot;})\n\n  (def app\n    (wrap-session\n      (ring/ring-handler\n      (ring/router [\n                    [\&quot;/\&quot; {:get home-page}]\n                    [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                   {:data {:middleware [parameters/parameters-middleware\n                                        wrap-keyword-params\n                                        ]}}))))\n\n\n\n  (defonce server (atom nil))\n\n  (defn start-server []\n    (when-not @server\n      (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n      (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.stop s)\n      (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.interrupt s)\n      (reset! server nil)))&quot;, :offset 7507, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n  (def port 3000)\n  (defn parse-date [date-str]\n    (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n      (LocalDate/now)\n      (try (LocalDate/parse date-str)\n           (catch Exception _ (LocalDate/now)))))\n\n  (defn format-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n  (defn nice-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n  (defn get-next-day [date]\n     (.plusDays date 1))\n  (defn get-previous-day [date]\n    (.minusDays date 1))\n\n  (defn insant-&gt;minutes-from-midnight [inst]\n    (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n          hour (.getHour zdt)\n          minute (.getMinute zdt)\n          (+ (* hour 60) minute)]))\n\n  (defn common-layout [&amp; content]\n    (html5\n      [:head\n       [:title \&quot;BeBetter\&quot;]\n       [:meta {:charset \&quot;UTF-8\&quot;}]\n       [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n       \&quot;\&quot;\n       [:style\n        \&quot;      \n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n          \n          /* SIDEBAR  */\n          .sidebar { \n            width: 245px; \n            background-color: #ffffff; \n            padding: 35px 20px 20px 20px; \n            position: fixed; \n            height: 100vh; \n            top: 0; left: 0; \n            z-index: 999; \n            border-right: 1px solid #dbdbdb; \n            display: flex; \n            flex-direction: column; \n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n          \n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n          \n          /* LINK */\n          .nav-link { \n            display: flex; \n            align-items: center; \n            padding: 12px; \n            color: #000; \n            text-decoration: none; \n            border-radius: 8px; \n            font-size: 16px; \n            transition: background 0.2s; \n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content { \n            margin-left: 245px; \n            padding: 40px; \n            width: calc(100% - 245px); \n          }\n          \n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n          \n          .calendar-container { border: 1px solid #dbdbdb; background: white; border-radius: 3px; }\n       \&quot;\n\n    ]]\n      [:body\n       [:sidebar\n        [:div.logo \&quot;BeBetter\&quot;]\n        [:a.nav-link {:hx-get \&quot;/planner\&quot; }] [:span \&quot;Planner\&quot;]]\n       [:main.main-content\n        content]\n       [:footer.footer\n        [:p \&quot;© 2024 BeBetter - Clojure + HTMX\&quot;]]]\n\n      ))\n  (defn sidebar []\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:span \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:a.nav-link\n       [:li [:span \&quot;Activity\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Feed\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Leaderboard\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Search\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;My Profile\&quot;]]]\n\n      ]])\n\n\n  (def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n  (defn day-column [selected-day]\n    [:div {:id \&quot;days-nav\&quot;\n           :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n     (for [d days]\n       [:div.day-column\n        {:class (when (= d selected-day) \&quot;selected\&quot;)\n         :hx-post \&quot;/select-day\&quot;\n         :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n         :hx-target \&quot;#calendar-view\&quot;\n         :hx-swap \&quot;outerHTML\&quot;}\n        d]\n       )]\n    )\n  (defn calendar-view [day]\n    [:div#calendar-view.calendar\n     [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n     [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n      (for [hour (range 24)]\n        [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n         (str hour \&quot;:00\&quot;)])]\n     ]\n    )\n\n  (defn home-page [{:keys [session]}]\n    (let [selected-day (:select-day session)] {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n             (common-layout\n               [:div\n                (sidebar )]\n               [:div\n                [:h2 \&quot;Calendar\&quot;]\n                (day-column selected-day)\n                (calendar-view selected-day)\n               ]\n               )\n             }))\n\n  (defn title-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Title updated\&quot;])})\n\n  (defn duration-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n  (defn activity-handler [request]\n    (let [title (get-in request [:params :title])\n          duration (get-in request [:params :duration])]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n      :body\n      (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n       })\n    )\n  (defn select-day-handler [{:keys [params session]}]\n    (let [day (:day params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :session (assoc session :select-day day)\n       :body (str (h/html (calendar-view day))\n                  (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                           (h/html (day-column day))]))})\n    )\n  (defn dummy-handler [request]\n    {:status 200 :body \&quot;OK\&quot;})\n\n  (def app\n    (wrap-session\n      (ring/ring-handler\n      (ring/router [\n                    [\&quot;/\&quot; {:get home-page}]\n                    [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                   {:data {:middleware [parameters/parameters-middleware\n                                        wrap-keyword-params\n                                        ]}}))))\n\n\n\n  (defonce server (atom nil))\n\n  (defn start-server []\n    (when-not @server\n      (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n      (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.stop s)\n      (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.interrupt s)\n      (reset! server nil)))&quot;, :offset 7449, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n  (def port 3000)\n  (defn parse-date [date-str]\n    (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n      (LocalDate/now)\n      (try (LocalDate/parse date-str)\n           (catch Exception _ (LocalDate/now)))))\n\n  (defn format-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n  (defn nice-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n  (defn get-next-day [date]\n     (.plusDays date 1))\n  (defn get-previous-day [date]\n    (.minusDays date 1))\n\n  (defn insant-&gt;minutes-from-midnight [inst]\n    (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n          hour (.getHour zdt)\n          minute (.getMinute zdt)\n          (+ (* hour 60) minute)]))\n\n  (defn common-layout [&amp; content]\n    (html5\n      [:head\n       [:title \&quot;BeBetter\&quot;]\n       [:meta {:charset \&quot;UTF-8\&quot;}]\n       [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n       \&quot;\&quot;\n       [:style\n        \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 1px solid #dbdbdb; background: white; border-radius: 3px; }\n       \&quot;\n\n    ]]\n      [:body\n       [:div.sidebar\n        [:div.logo-wrapper\n         [:div.logo \&quot;BeBetter\&quot;]]\n        [:ul.sidebar-menu\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;📅\&quot;] [:span \&quot;Planer\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n       [:main.main-content\n        content]\n       ]\n\n      ))\n  (defn sidebar []\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:span \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:a.nav-link\n       [:li [:span \&quot;Activity\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Feed\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Leaderboard\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Search\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;My Profile\&quot;]]]\n\n      ]])\n\n\n  (def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n  (defn day-column [selected-day]\n    [:div {:id \&quot;days-nav\&quot;\n           :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n     (for [d days]\n       [:div.day-column\n        {:class (when (= d selected-day) \&quot;selected\&quot;)\n         :hx-post \&quot;/select-day\&quot;\n         :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n         :hx-target \&quot;#calendar-view\&quot;\n         :hx-swap \&quot;outerHTML\&quot;}\n        d]\n       )]\n    )\n  (defn calendar-view [day]\n    [:div#calendar-view.calendar\n     [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n     [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n      (for [hour (range 24)]\n        [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n         (str hour \&quot;:00\&quot;)])]\n     ]\n    )\n\n  (defn home-page [{:keys [session]}]\n    (let [selected-day (:select-day session)] {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n             (common-layout\n               [:div\n                (sidebar )]\n               [:div\n                [:h2 \&quot;Calendar\&quot;]\n                (day-column selected-day)\n                (calendar-view selected-day)\n               ]\n               )\n             }))\n\n  (defn title-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Title updated\&quot;])})\n\n  (defn duration-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n  (defn activity-handler [request]\n    (let [title (get-in request [:params :title])\n          duration (get-in request [:params :duration])]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n      :body\n      (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n       })\n    )\n  (defn select-day-handler [{:keys [params session]}]\n    (let [day (:day params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :session (assoc session :select-day day)\n       :body (str (h/html (calendar-view day))\n                  (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                           (h/html (day-column day))]))})\n    )\n  (defn dummy-handler [request]\n    {:status 200 :body \&quot;OK\&quot;})\n\n  (def app\n    (wrap-session\n      (ring/ring-handler\n      (ring/router [\n                    [\&quot;/\&quot; {:get home-page}]\n                    [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                   {:data {:middleware [parameters/parameters-middleware\n                                        wrap-keyword-params\n                                        ]}}))))\n\n\n\n  (defonce server (atom nil))\n\n  (defn start-server []\n    (when-not @server\n      (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n      (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.stop s)\n      (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.interrupt s)\n      (reset! server nil)))&quot;, :offset 7670, :ns &quot;web.server&quot;} {:command &quot;(defn duration-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Duration updated\&quot;])})&quot;, :offset 141, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n  (def port 3000)\n  (defn parse-date [date-str]\n    (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n      (LocalDate/now)\n      (try (LocalDate/parse date-str)\n           (catch Exception _ (LocalDate/now)))))\n\n  (defn format-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n  (defn nice-date [date]\n    (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n  (defn get-next-day [date]\n     (.plusDays date 1))\n  (defn get-previous-day [date]\n    (.minusDays date 1))\n\n  (defn insant-&gt;minutes-from-midnight [inst]\n    (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n          hour (.getHour zdt)\n          minute (.getMinute zdt)\n          (+ (* hour 60) minute)]))\n\n  (defn common-layout [&amp; content]\n    (html5\n      [:head\n       [:title \&quot;BeBetter\&quot;]\n       [:meta {:charset \&quot;UTF-8\&quot;}]\n       [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n       \&quot;\&quot;\n       [:style\n        \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 1px solid #dbdbdb; background: white; border-radius: 3px; }\n       \&quot;\n\n    ]]\n      [:body\n       [:div.sidebar\n        [:div.logo-wrapper\n         [:div.logo \&quot;BeBetter\&quot;]]\n        [:ul.sidebar-menu\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;📅\&quot;] [:span \&quot;Planer\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n         [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n       [:main.main-content\n        content]\n       ]\n\n      ))\n  (defn sidebar []\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:span \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:a.nav-link\n       [:li [:span \&quot;Activity\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Feed\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Leaderboard\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;Search\&quot;]]]\n      [:a.nav-link\n       [:li [:span \&quot;My Profile\&quot;]]]\n\n      ]])\n\n\n  (def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n  (defn day-column [selected-day]\n    [:div {:id \&quot;days-nav\&quot;\n           :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n     (for [d days]\n       [:div.day-column\n        {:class (when (= d selected-day) \&quot;selected\&quot;)\n         :hx-post \&quot;/select-day\&quot;\n         :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n         :hx-target \&quot;#calendar-view\&quot;\n         :hx-swap \&quot;outerHTML\&quot;}\n        d]\n       )]\n    )\n  (defn calendar-view [day]\n    [:div#calendar-view.calendar\n     [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n     [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n      (for [hour (range 24)]\n        [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n         (str hour \&quot;:00\&quot;)])]\n     ]\n    )\n\n  (defn home-page [{:keys [session]}]\n    (let [selected-day (:select-day session)] {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n             (common-layout\n               [:div\n                [:h2 \&quot;Calendar\&quot;]\n                (day-column selected-day)\n                (calendar-view selected-day)\n               ]\n               )\n             }))\n\n  (defn title-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Title updated\&quot;])})\n\n  (defn duration-handler [request]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n  (defn activity-handler [request]\n    (let [title (get-in request [:params :title])\n          duration (get-in request [:params :duration])]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n      :body\n      (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])\n       })\n    )\n  (defn select-day-handler [{:keys [params session]}]\n    (let [day (:day params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :session (assoc session :select-day day)\n       :body (str (h/html (calendar-view day))\n                  (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                           (h/html (day-column day))]))})\n    )\n  (defn dummy-handler [request]\n    {:status 200 :body \&quot;OK\&quot;})\n\n  (def app\n    (wrap-session\n      (ring/ring-handler\n      (ring/router [\n                    [\&quot;/\&quot; {:get home-page}]\n                    [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                   {:data {:middleware [parameters/parameters-middleware\n                                        wrap-keyword-params\n                                        ]}}))))\n\n\n\n  (defonce server (atom nil))\n\n  (defn start-server []\n    (when-not @server\n      (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n      (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.stop s)\n      (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n  (defn stop-server []\n    (when-some [s @server] ;; check if there is an object in the atom\n      (.interrupt s)\n      (reset! server nil)))&quot;, :offset 7621, :ns &quot;project.core&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))&quot;, :offset 639, :ns &quot;project.core&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 1px solid #dbdbdb; background: white; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 7423, :ns &quot;project.core&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: white; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 7424, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:20px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 7425, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 7424, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0; height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)}\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 7516, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 7662, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body (h/html (slot-form hour))})\n  )\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8336, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body (h/html (slot-form hour))})\n  )\n(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title])\n\n     }))\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8705, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n          \n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body (h/html (slot-form hour))})\n  )\n(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title])\n\n     }))\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8767, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body (h/html (slot-form hour))})\n  )\n(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title])\n     }))\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8756, :ns &quot;web.server&quot;} {:command &quot;(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))&quot;, :offset 408, :ns &quot;web.server&quot;} {:command &quot;(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body (h/html (slot-form hour))})\n  )&quot;, :offset 172, :ns &quot;web.server&quot;} {:command &quot;(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body \&quot;(h/html (slot-form hour))\&quot;})\n  )&quot;, :offset 174, :ns &quot;web.server&quot;} {:command &quot;(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers \&quot;Content-Type\&quot; \&quot;text/html\&quot;\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    hour])\n     }))&quot;, :offset 266, :ns &quot;web.server&quot;} {:command &quot;(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title])\n     }))&quot;, :offset 302, :ns &quot;web.server&quot;} {:command &quot;(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html (slot-form hour))\n     }))&quot;, :offset 177, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html (slot-form hour))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title])\n     }))\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8762, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title])\n     }))\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8768, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (let [title (:title params)\n        hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n                    title]))\n     }))\n\n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8774, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot;}\n    [:option  {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option  {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option  {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn title-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Title updated\&quot;])})\n\n(defn duration-handler [request]\n  {:status 200\n   :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n   :body (html5 [:small \&quot;Duration updated\&quot;])})\n\n(defn activity-handler [request]\n  (let [title (get-in request [:params :title])\n        duration (get-in request [:params :duration])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (html5 [:p \&quot;Activity: \&quot; title \&quot;, duration: \&quot; duration])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (let [intensity (:intensity params)\n        day-time (:day-time params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str \&quot;Activity @ \&quot; day-time \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n  \n(defn dummy-handler [request]\n  {:status 200 :body \&quot;OK\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8839, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;intensity\&quot; :id \&quot;intensity\&quot;}\n    [:option {:value \&quot;\&quot;} \&quot;-- choose --\&quot;]\n    [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)] {:status 200\n                                             :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n                                             :body\n                                             (common-layout\n                                              [:div\n                                               [:h2 \&quot;Calendar\&quot;]\n                                               (day-column selected-day)\n                                               (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [intensity (:intensity params)\n        day-time (:day-time params)]\n    \n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str \&quot;Activity @ \&quot; day-time \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8329, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-indicator \&quot;.spinner\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:select {:name \&quot;title\&quot;}\n    [:option {:value \&quot;\&quot; :disabled true :selected true} \&quot;Choose intensity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]\n\n   [:select {:name \&quot;intensity\&quot; :id \&quot;intensity\&quot;}\n    [:option {:value \&quot;\&quot; :disabled true :selected true} \&quot;Choose intensity\&quot;]\n    [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n   [:button {:type \&quot;submit\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8334, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true :style \&quot;width: 100%;\&quot;}\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true :style \&quot;width: 100%;\&quot;}\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n\n   [:button {:type \&quot;submit\&quot; :style \&quot;width: 100%;\&quot;} \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8570, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8507, :ns &quot;web.server&quot;} {:command &quot;(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        \n        }\n       (str hour \&quot;:00\&quot;)])]])&quot;, :offset 546, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        \n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8482, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot;  }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8492, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    \n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8424, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style {\&quot;display: flex;\&quot;}}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n   \n   [:select {:name \&quot;intensity\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n    [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8790, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n   [:select {:name \&quot;intensity\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n    [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n    [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n    [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8785, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          \n          :style \&quot;display: flex;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8506, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;closest .hour-slot\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (:day-time params)]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div {:style \&quot;background:#2c3e50; color:white; padding:4px; border-radius:4px;\&quot;}\n          (str title \&quot; @ \&quot; hour \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 8540, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    [:div#calendar-layer\n     {:style \&quot;position:absolute; inset:0;\&quot;}]]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:style (str\n                    \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background:#2c3e50;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:5;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 9281, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer;\&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    [:div#calendar-layer\n     {:style \&quot;position:absolute; inset:0;\&quot;}]]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:style (str\n                    \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background:#2c3e50;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:5;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 9281, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:style (str\n                    \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background: black;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:10;\n                    pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 9391, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:style (str\n                    \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background:#2c3e50;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:10;\n                    pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 9392, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [java.util UUID]\n              [clojure.data.json :as json])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))&quot;, :offset 743, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [clojure.data.json :as json])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))&quot;, :offset 712, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [clojure.data.json :as json])\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        id (str (UUID/randomUUid))\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:id (str \&quot;act-\&quot; id)\n           :hx-get \&quot;/activity-edit\&quot;\n           :hx-vals (str \&quot;{\\\&quot;id\\\&quot;:\\\&quot;\&quot; id \&quot;\\\&quot;}\&quot;)\n           :style (str\n                    \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background:#2c3e50;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:10;\n                    pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 9615, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [clojure.data.json :as json]\n              [java.util :as UUID]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (str \&quot;{\\\&quot;day\\\&quot;: \\\&quot;\&quot; d \&quot;\\\&quot;}\&quot;)\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (str \&quot;{\\\&quot;hour\\\&quot;: \&quot; hour \&quot;}\&quot;)\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        id (str (UUID/randomUUid))\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:id (str \&quot;act-\&quot; id)\n           :hx-get \&quot;/activity-edit\&quot;\n           :hx-vals (str \&quot;{\\\&quot;id\\\&quot;:\\\&quot;\&quot; id \&quot;\\\&quot;}\&quot;)\n           :style (str\n                    \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background:#2c3e50;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:10;\n                    pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 9665, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [clojure.data.json :as json]\n              [java.util :as UUID]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))&quot;, :offset 762, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              [java.util :as UUID]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))&quot;, :offset 761, :ns &quot;web.server&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              #_[java.util :as UUID]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n      #_(java.util UUID)))&quot;, :offset 758, :ns &quot;project.core&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              [java.util :as UUID]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n      (java.util UUID)))&quot;, :offset 754, :ns &quot;project.core&quot;} {:command &quot;(ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))&quot;, :offset 726, :ns &quot;project.core&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (generate-string {:day d})\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (generate-string {:hour hour})\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n  (defn activity-edit-view [id]\n    [:div {:style \&quot;background:#fff; border:1px solid #ccc; padding:6px; border-radius:6px;\&quot;}\n     [:button {:hx-delete \&quot;/activity\&quot;\n               :hx-vals (generate-string {:id id})\n               :hx-target \&quot;closest .activity-block\&quot;\n               :hx-swap \&quot;outerHTML\&quot;}\n      \&quot;Delete\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        id (str (UUID/randomUUID))\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:id (str \&quot;act-\&quot; id)\n           :hx-get \&quot;/activity-edit\&quot;\n           :hx-vals (generate-string {:id id})\n           :hx-target \&quot;this\&quot;\n           :hx-swap \&quot;outerHTML\&quot;\n           :style (str \&quot;position:absolute;\&quot; \&quot;top:\&quot; top \&quot;px;\&quot; \&quot;left:4px;\&quot; \&quot;right:4px;\&quot; \&quot;height:\&quot; height \&quot;px;\&quot;\n           \&quot;background:#2c3e50;\&quot; \&quot;color:white;\&quot; \&quot;border-radius:6px;\&quot; \&quot;padding:6px;\&quot; \&quot;z-index:10;\n                   pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n  (defn activity-edit-handler [{:keys [params]}]\n    (let [id (:id params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body (str (h/html (activity-edit-view id)))})\n    )\n\n  (defn activity-delete-handler [_]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body \&quot;\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]\n                  [\&quot;/activity-edit\&quot; {:get activity-edit-handler}]\n                  [\&quot;/activity\&quot; {:delete delete-activity-handler}]\n                  ]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 10290, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; display: flex; min-height: 100vh; background-color: #fafafa; }\n\n          /* SIDEBAR  */\n          .sidebar {\n            width: 245px;\n            background-color: #ffffff;\n            padding: 35px 20px 20px 20px;\n            position: fixed;\n            height: 100vh;\n            top: 0; left: 0;\n            z-index: 999;\n            border-right: 1px solid #dbdbdb;\n            display: flex;\n            flex-direction: column;\n          }\n          .logo-wrapper { width: 100%; margin-bottom: 30px; padding-left: 10px; }\n          .logo { font-size: 24px; font-weight: bold; font-family: cursive; } /* Tvoj font ovde */\n\n          .sidebar-menu { list-style-type: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }\n\n          /* LINK */\n          .nav-link {\n            display: flex;\n            align-items: center;\n            padding: 12px;\n            color: #000;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 16px;\n            transition: background 0.2s;\n          }\n          .nav-link:hover { background-color: #f2f2f2; }\n          .nav-link.active { font-weight: bold; }\n          .nav-link span { margin-left: 15px; }\n\n          /* MAIN CONTENT (Pomeren desno zbog sidebara) */\n          .main-content {\n            margin-left: 245px;\n            padding: 40px;\n            width: calc(100% - 245px);\n          }\n\n          /* KALENDAR STILOVI */\n          .day-column { border: 1px solid #ccc; padding: 1rem; cursor: pointer; transition: background 0.2s; flex: 1; text-align: center; }\n          .day-column:hover { background: #f0f0f0; }\n          .day-column.selected { background: #2c3e50; color: white; border-color: #2c3e50; }\n\n          .calendar-container { border: 10px solid #dbdbdb; background: black; border-radius: 3px; }\n\n          .hour-slot:hover { background: #f7f7f7;}\n       \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (generate-string {:day d})\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (generate-string {:hour hour})\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n  (defn activity-edit-view [id]\n    [:div {:style \&quot;background:#fff; border:1px solid #ccc; padding:6px; border-radius:6px;\&quot;}\n     [:button {:hx-delete \&quot;/activity\&quot;\n               :hx-vals (generate-string {:id id})\n               :hx-target \&quot;closest .activity-block\&quot;\n               :hx-swap \&quot;outerHTML\&quot;}\n      \&quot;Delete\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        id (str (UUID/randomUUID))\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:id (str \&quot;act-\&quot; id)\n           :hx-get \&quot;/activity-edit\&quot;\n           :hx-vals (generate-string {:id id})\n           :hx-target \&quot;this\&quot;\n           :hx-swap \&quot;outerHTML\&quot;\n           :style (str \&quot;position:absolute;\&quot; \&quot;top:\&quot; top \&quot;px;\&quot; \&quot;left:4px;\&quot; \&quot;right:4px;\&quot; \&quot;height:\&quot; height \&quot;px;\&quot;\n           \&quot;background:#2c3e50;\&quot; \&quot;color:white;\&quot; \&quot;border-radius:6px;\&quot; \&quot;padding:6px;\&quot; \&quot;z-index:10;\n                   pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n  (defn activity-edit-handler [{:keys [params]}]\n    (let [id (:id params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body (str (h/html (activity-edit-view id)))})\n    )\n\n  (defn activity-delete-handler [_]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body \&quot;\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]\n                  [\&quot;/activity-edit\&quot; {:get activity-edit-handler}]\n                  [\&quot;/activity\&quot; {:delete activity-delete-handler}]\n                  ]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 10290, :ns &quot;web.server&quot;} {:command &quot;start-server&quot;, :offset 12, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n        /* RESET &amp; BASE */\n        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }\n        body { background-color: #f8f9fa; color: #333; display: flex; height: 100vh; overflow: hidden; }\n        \n        /* SIDEBAR */\n        .sidebar { width: 260px; background: white; border-right: 1px solid #e0e0e0; display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; z-index: 50; }\n        .logo { font-size: 24px; font-weight: 800; color: #2c3e50; margin-bottom: 40px; padding-left: 10px; }\n        .nav-link { display: flex; align-items: center; padding: 12px 15px; color: #555; text-decoration: none; border-radius: 8px; margin-bottom: 5px; font-weight: 500; transition: all 0.2s; }\n        .nav-link:hover { background-color: #f0f4f8; color: #2c3e50; }\n        .nav-link span { margin-right: 12px; font-size: 1.1em; }\n\n        /* MAIN CONTENT */\n        .main-content { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; }\n        h2 { font-size: 28px; margin-bottom: 20px; color: #2c3e50; font-weight: 600; }\n\n        /* DAY SELECTOR */\n        #days-nav { display: flex; gap: 10px; margin-bottom: 20px; background: white; padding: 10px; border-radius: 12px; border: 1px solid #e0e0e0; width: fit-content; }\n        .day-column { padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; color: #777; transition: all 0.2s; border: 1px solid transparent; }\n        .day-column:hover { background-color: #f8f9fa; color: #333; }\n        .day-column.selected { background-color: #2c3e50; color: white; box-shadow: 0 4px 6px rgba(44, 62, 80, 0.2); }\n\n        /* KALENDAR GRID */\n        .calendar-wrapper { position: relative; background: white; border-radius: 12px; border: 1px solid #e0e0e0; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\n        .calendar-scroll { height: 70vh; overflow-y: auto; position: relative; } /* Skroluje samo kalendar */\n        \n        .hour-row { height: 60px; border-bottom: 1px solid #f0f0f0; position: relative; display: flex; align-items: center; }\n        .hour-label { width: 60px; text-align: right; padding-right: 15px; color: #999; font-size: 12px; font-weight: 500; user-select: none; }\n        .hour-slot { flex: 1; height: 100%; cursor: pointer; transition: background 0.1s; position: relative; border-left: 1px solid #f0f0f0; }\n        .hour-slot:hover { background-color: #fcfcfc; }\n\n        /* FORMA U SLOTU */\n        .slot-form-container { padding: 10px; background: white; border-radius: 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 1px solid #e0e0e0; z-index: 100; position: absolute; top: 5px; left: 5px; width: 300px; animation: fadeIn 0.2s; }\n        .slot-form { display: flex; gap: 8px; flex-wrap: wrap; }\n        .slot-form select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; background: #fff; flex: 1; font-size: 13px; }\n        .slot-form button { padding: 8px 15px; background: #2c3e50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 13px; }\n        .slot-form button:hover { background: #34495e; }\n\n        /* AKTIVNOST BLOK */\n        .activity-block { \n            position: absolute; left: 65px; right: 10px; \n            background: #e3f2fd; border-left: 4px solid #2196f3; \n            color: #1565c0; padding: 8px 12px; border-radius: 4px; \n            font-size: 13px; font-weight: 500; \n            box-shadow: 0 2px 4px rgba(0,0,0,0.05); \n            cursor: pointer; transition: transform 0.1s; \n            z-index: 20; pointer-events: auto;\n            display: flex; align-items: center; justify-content: space-between;\n        }\n        .activity-block:hover { transform: scale(1.01); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }\n        .activity-actions button { background: none; border: none; cursor: pointer; color: #d32f2f; font-size: 12px; font-weight: bold; }\n\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }\n     \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (generate-string {:day d})\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div {:style \&quot;position:relative; height:1440px; border:1px solid #ccc;\&quot;}\n    [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none;\&quot;}]\n    (for [hour (range 24)]\n      [:div.hour-slot\n       {:style (str \&quot;position:absolute; top:\&quot; (* hour 60) \&quot;px; left: 0; right: 0;\n       height:60px; border-top:1px solid #eee; cursor:pointer; z-index: 1;  \&quot;)\n        :hx-get \&quot;/slot-form\&quot;\n        :hx-vals (generate-string {:hour hour})\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;innerHTML\&quot;\n        :hx-trigger \&quot;click once\&quot;\n        }\n       (str hour \&quot;:00\&quot;)])\n    ]])\n\n(defn slot-form [day-time]\n  [:form {:hx-post \&quot;/add-activity\&quot;\n          :hx-target \&quot;#calendar-layer\&quot;\n          :hx-swap \&quot;beforeend\&quot;\n          :onclick \&quot;event.stopPropagation()\&quot;\n          :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n   [:select {:name \&quot;title\&quot; :required true }\n    [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n    [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n    [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n    [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]]\n\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n    ]\n   [:div {:style \&quot;margin-bottom: 5px;\&quot;}\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]])\n\n  (defn activity-edit-view [id]\n    [:div {:style \&quot;background:#fff; border:1px solid #ccc; padding:6px; border-radius:6px;\&quot;}\n     [:button {:hx-delete \&quot;/activity\&quot;\n               :hx-vals (generate-string {:id id})\n               :hx-target \&quot;closest .activity-block\&quot;\n               :hx-swap \&quot;outerHTML\&quot;}\n      \&quot;Delete\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (* hour 60)\n        height (* duration 60)\n        id (str (UUID/randomUUID))\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:id (str \&quot;act-\&quot; id)\n           :hx-get \&quot;/activity-edit\&quot;\n           :hx-vals (generate-string {:id id})\n           :hx-target \&quot;this\&quot;\n           :hx-swap \&quot;outerHTML\&quot;\n           :style (str \&quot;position:absolute;\&quot; \&quot;top:\&quot; top \&quot;px;\&quot; \&quot;left:4px;\&quot; \&quot;right:4px;\&quot; \&quot;height:\&quot; height \&quot;px;\&quot;\n           \&quot;background:#2c3e50;\&quot; \&quot;color:white;\&quot; \&quot;border-radius:6px;\&quot; \&quot;padding:6px;\&quot; \&quot;z-index:10;\n                   pointer-events: auto;\&quot;)}\n          (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))}))\n\n  (defn activity-edit-handler [{:keys [params]}]\n    (let [id (:id params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body (str (h/html (activity-edit-view id)))})\n    )\n\n  (defn activity-delete-handler [_]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body \&quot;\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]\n                  [\&quot;/activity-edit\&quot; {:get activity-edit-handler}]\n                  [\&quot;/activity\&quot; {:delete activity-delete-handler}]\n                  ]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 12270, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n        /* RESET &amp; BASE */\n        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }\n        body { background-color: #f8f9fa; color: #333; display: flex; height: 100vh; overflow: hidden; }\n\n        /* SIDEBAR */\n        .sidebar { width: 260px; background: white; border-right: 1px solid #e0e0e0; display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; z-index: 50; }\n        .logo { font-size: 24px; font-weight: 800; color: #2c3e50; margin-bottom: 40px; padding-left: 10px; }\n        .nav-link { display: flex; align-items: center; padding: 12px 15px; color: #555; text-decoration: none; border-radius: 8px; margin-bottom: 5px; font-weight: 500; transition: all 0.2s; }\n        .nav-link:hover { background-color: #f0f4f8; color: #2c3e50; }\n        .nav-link span { margin-right: 12px; font-size: 1.1em; }\n\n        /* MAIN CONTENT */\n        .main-content { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; }\n        h2 { font-size: 28px; margin-bottom: 20px; color: #2c3e50; font-weight: 600; }\n\n        /* DAY SELECTOR */\n        #days-nav { display: flex; gap: 10px; margin-bottom: 20px; background: white; padding: 10px; border-radius: 12px; border: 1px solid #e0e0e0; width: fit-content; }\n        .day-column { padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; color: #777; transition: all 0.2s; border: 1px solid transparent; }\n        .day-column:hover { background-color: #f8f9fa; color: #333; }\n        .day-column.selected { background-color: #2c3e50; color: white; box-shadow: 0 4px 6px rgba(44, 62, 80, 0.2); }\n\n        /* KALENDAR GRID */\n        .calendar-wrapper { position: relative; background: white; border-radius: 12px; border: 1px solid #e0e0e0; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\n        .calendar-scroll { height: 70vh; overflow-y: auto; position: relative; } /* Skroluje samo kalendar */\n\n        .hour-row { height: 60px; border-bottom: 1px solid #f0f0f0; position: relative; display: flex; align-items: center; }\n        .hour-label { width: 60px; text-align: right; padding-right: 15px; color: #999; font-size: 12px; font-weight: 500; user-select: none; }\n        .hour-slot { flex: 1; height: 100%; cursor: pointer; transition: background 0.1s; position: relative; border-left: 1px solid #f0f0f0; }\n        .hour-slot:hover { background-color: #fcfcfc; }\n\n        /* FORMA U SLOTU */\n        .slot-form-container { padding: 10px; background: white; border-radius: 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 1px solid #e0e0e0; z-index: 100; position: absolute; top: 5px; left: 5px; width: 300px; animation: fadeIn 0.2s; }\n        .slot-form { display: flex; gap: 8px; flex-wrap: wrap; }\n        .slot-form select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; background: #fff; flex: 1; font-size: 13px; }\n        .slot-form button { padding: 8px 15px; background: #2c3e50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 13px; }\n        .slot-form button:hover { background: #34495e; }\n\n        /* AKTIVNOST BLOK */\n        .activity-block {\n            position: absolute; left: 65px; right: 10px;\n            background: #e3f2fd; border-left: 4px solid #2196f3;\n            color: #1565c0; padding: 8px 12px; border-radius: 4px;\n            font-size: 13px; font-weight: 500;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n            cursor: pointer; transition: transform 0.1s;\n            z-index: 20; pointer-events: auto;\n            display: flex; align-items: center; justify-content: space-between;\n        }\n        .activity-block:hover { transform: scale(1.01); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }\n        .activity-actions button { background: none; border: none; cursor: pointer; color: #d32f2f; font-size: 12px; font-weight: bold; }\n\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }\n     \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (generate-string {:day d})\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n\n(defn calendar-view [day]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;none\&quot;))]\n   [:div.calendar-wrapper\n    [:div.calendar-scroll\n     [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: none; z-index: 10;\&quot;}]\n     (for [hour (range 24)]\n       [:div.hour-row\n        [:div.hour-label (str hour \&quot;:00\&quot;)]\n        [:div.hour-slot\n         {:hx-get \&quot;/slot-form\&quot;\n          :hx-vals (generate-string {:hour hour})\n          :hx-target \&quot;this\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-trigger \&quot;click once\&quot;}]])]\n    ]])\n\n(defn slot-form [day-time]\n  [:div.slot-form-container {:onclick \&quot;event.stopPropagation()\&quot;}\n   [:form.slot-form\n    {:hx-post \&quot;/add-activity\&quot;\n     :hx-target \&quot;#calendar-layer\&quot;\n     :hx-swap \&quot;beforeend\&quot;\n     :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n    [:select {:name \&quot;title\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n     [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n     [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n     [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]\n\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]]])\n\n  (defn activity-edit-view [id]\n    [:div {:style \&quot;background:#fff; border:1px solid #ccc; padding:6px; border-radius:6px;\&quot;}\n     [:button {:hx-delete \&quot;/activity\&quot;\n               :hx-vals (generate-string {:id id})\n               :hx-target \&quot;closest .activity-block\&quot;\n               :hx-swap \&quot;outerHTML\&quot;}\n      \&quot;Delete\&quot;]])\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [title (:title params)\n        intensity (:intensity params)\n        hour  (Integer/parseInt (:day-time params))\n        duration (Integer/parseInt (:duration params))\n        top (+ 1 (* hour 60))\n        height (- (* duration 60) 2)\n        id (str (UUID/randomUUID))\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (str\n       (h/html\n         [:div.activity-block\n          {:id (str \&quot;act-\&quot; id)\n           :style (str \&quot;top:\&quot; top \&quot;px; height:\&quot; height \&quot;px;\&quot;)}\n\n          [:span (str title \&quot; (\&quot; duration \&quot;h)\&quot;)]\n          [:div.activity-actions\n           [:button {:hx-delete \&quot;/activity\&quot;\n                     :hx-vals (generate-string {:id id})\n                     :hx-target (str \&quot;#act-\&quot; id)\n                     :hx-swap \&quot;outerHTML\&quot;}\n            \&quot;button\&quot;]]]))}))\n\n  (defn activity-edit-handler [{:keys [params]}]\n    (let [id (:id params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body (str (h/html (activity-edit-view id)))})\n    )\n\n  (defn activity-delete-handler [_]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body \&quot;\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]\n                  [\&quot;/activity-edit\&quot; {:get activity-edit-handler}]\n                  [\&quot;/activity\&quot; {:delete activity-delete-handler}]\n                  ]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 11960, :ns &quot;project.core&quot;} {:command &quot;(start-server)&quot;, :offset 13, :ns &quot;web.server&quot;} {:command &quot;(defn activity-&gt;block [{:keys [id title intensity duration hour]}]\n    (let [top (* 60 hour)\n          height (* duration 60)]\n      [:div.activity-block\n       {:id id\n        :hx-get \&quot;/activity-edit\&quot;\n        :hx-target \&quot;this\&quot;\n        :hx-swap \&quot;outerHTML\&quot;\n        :hx-vals (generate-string {:id id})\n        :style (str \&quot;position:absolute;\&quot;\n                    \&quot;top:\&quot; top \&quot;px;\&quot;\n                    \&quot;left:4px;\&quot;\n                    \&quot;right:4px;\&quot;\n                    \&quot;height:\&quot; height \&quot;px;\&quot;\n                    \&quot;background:#2c3e50;\&quot;\n                    \&quot;color:white;\&quot;\n                    \&quot;border-radius:6px;\&quot;\n                    \&quot;padding:6px;\&quot;\n                    \&quot;z-index:10;\&quot;)}\n       (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))&quot;, :offset 716, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n        /* RESET &amp; BASE */\n        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }\n        body { background-color: #f8f9fa; color: #333; display: flex; height: 100vh; overflow: hidden; }\n\n        /* SIDEBAR */\n        .sidebar { width: 260px; background: white; border-right: 1px solid #e0e0e0; display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; z-index: 50; }\n        .logo { font-size: 24px; font-weight: 800; color: #2c3e50; margin-bottom: 40px; padding-left: 10px; }\n        .nav-link { display: flex; align-items: center; padding: 12px 15px; color: #555; text-decoration: none; border-radius: 8px; margin-bottom: 5px; font-weight: 500; transition: all 0.2s; }\n        .nav-link:hover { background-color: #f0f4f8; color: #2c3e50; }\n        .nav-link span { margin-right: 12px; font-size: 1.1em; }\n\n        /* MAIN CONTENT */\n        .main-content { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; }\n        h2 { font-size: 28px; margin-bottom: 20px; color: #2c3e50; font-weight: 600; }\n\n        /* DAY SELECTOR */\n        #days-nav { display: flex; gap: 10px; margin-bottom: 20px; background: white; padding: 10px; border-radius: 12px; border: 1px solid #e0e0e0; width: fit-content; }\n        .day-column { padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; color: #777; transition: all 0.2s; border: 1px solid transparent; }\n        .day-column:hover { background-color: #f8f9fa; color: #333; }\n        .day-column.selected { background-color: #2c3e50; color: white; box-shadow: 0 4px 6px rgba(44, 62, 80, 0.2); }\n\n        /* KALENDAR GRID */\n        .calendar-wrapper { position: relative; background: white; border-radius: 12px; border: 1px solid #e0e0e0; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\n        .calendar-scroll { height: 70vh; overflow-y: auto; position: relative; } /* Skroluje samo kalendar */\n\n        .hour-row { height: 60px; border-bottom: 1px solid #f0f0f0; position: relative; display: flex; align-items: center; }\n        .hour-label { width: 60px; text-align: right; padding-right: 15px; color: #999; font-size: 12px; font-weight: 500; user-select: none; }\n        .hour-slot { flex: 1; height: 100%; cursor: pointer; transition: background 0.1s; position: relative; border-left: 1px solid #f0f0f0; }\n        .hour-slot:hover { background-color: #fcfcfc; }\n\n        /* FORMA U SLOTU */\n        .slot-form-container { padding: 10px; background: white; border-radius: 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 1px solid #e0e0e0; z-index: 100; position: absolute; top: 5px; left: 5px; width: 300px; animation: fadeIn 0.2s; }\n        .slot-form { display: flex; gap: 8px; flex-wrap: wrap; }\n        .slot-form select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; background: #fff; flex: 1; font-size: 13px; }\n        .slot-form button { padding: 8px 15px; background: #2c3e50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 13px; }\n        .slot-form button:hover { background: #34495e; }\n\n        /* AKTIVNOST BLOK */\n        .activity-block {\n            position: absolute; left: 65px; right: 10px;\n            background: #e3f2fd; border-left: 4px solid #2196f3;\n            color: #1565c0; padding: 8px 12px; border-radius: 4px;\n            font-size: 13px; font-weight: 500;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n            cursor: pointer; transition: transform 0.1s;\n            z-index: 20; pointer-events: auto;\n            display: flex; align-items: center; justify-content: space-between;\n        }\n        .activity-block:hover { transform: scale(1.01); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }\n        .activity-actions button { background: none; border: none; cursor: pointer; color: #d32f2f; font-size: 12px; font-weight: bold; }\n\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }\n     \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (generate-string {:day d})\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n(defn activity-&gt;block [{:keys [id title intensity duration hour]}]\n  (let [top (* 60 hour)\n        height (* duration 60)]\n    [:div.activity-block\n     {:id id\n      :hx-get \&quot;/activity-edit\&quot;\n      :hx-target \&quot;this\&quot;\n      :hx-swap \&quot;outerHTML\&quot;\n      :hx-vals (generate-string {:id id})\n      :style (str \&quot;position:absolute;\&quot;\n                  \&quot;top:\&quot; top \&quot;px;\&quot;\n                  \&quot;left:4px;\&quot;\n                  \&quot;right:4px;\&quot;\n                  \&quot;height:\&quot; height \&quot;px;\&quot;\n                  \&quot;background:#2c3e50;\&quot;\n                  \&quot;color:white;\&quot;\n                  \&quot;border-radius:6px;\&quot;\n                  \&quot;padding:6px;\&quot;\n                  \&quot;z-index:10;\&quot;)}\n     (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))\n\n(defn calendar-view [day activities]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;Monday\&quot;))]\n   [:div.calendar-wrapper\n    [:div.calendar-scroll\n     [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: auto; z-index: 10;\&quot;}]\n\n     (for [a activities]\n       (activity-&gt;block a))\n\n     (for [hour (range 24)]\n       [:div.hour-row\n        [:div.hour-label (str hour \&quot;:00\&quot;)]\n        [:div.hour-slot\n         {:hx-get \&quot;/slot-form\&quot;\n          :hx-vals (generate-string {:hour hour})\n          :hx-target \&quot;this\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-trigger \&quot;click once\&quot;}]])]\n    ]])\n\n\n(defn slot-form [day-time]\n  [:div.slot-form-container {:onclick \&quot;event.stopPropagation()\&quot;}\n   [:form.slot-form\n    {:hx-post \&quot;/add-activity\&quot;\n     :hx-target \&quot;#calendar-layer\&quot;\n     :hx-swap \&quot;beforeend\&quot;\n     :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n    [:select {:name \&quot;title\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n     [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n     [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n     [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]\n\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]]])\n\n  (defn activity-edit-view [id]\n    [:div {:style \&quot;background:#fff; border:1px solid #ccc; padding:6px; border-radius:6px;\&quot;}\n     [:button {:hx-delete \&quot;/activity\&quot;\n               :hx-vals (generate-string {:id id})\n               :hx-target \&quot;closest .activity-block\&quot;\n               :hx-swap \&quot;outerHTML\&quot;}\n      \&quot;Delete\&quot;]])\n\n\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)\n        activities (get-in session [:activities selected-day] [])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day session)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)\n        activities (get-in session [:activities day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day activities))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params session]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [day (:select-day session)\n        id (str (UUID/randomUUID))\n        activities {:id id\n                    :title (:title params)\n                    :duration (Integer/parseInt (:duration params))\n                    :intensity (:intensity params)\n                    :hour (Integer/parseInt (:hour params)  )}\n\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (update-in session [:activities day] (fnil conj []) act)\n     :body\n     (str\n       (h/html (activity-&gt;block activities)))}))\n\n  (defn activity-edit-handler [{:keys [params]}]\n    (let [id (:id params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body (str (h/html (activity-edit-view id)))})\n    )\n\n  (defn activity-delete-handler [_]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body \&quot;\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]\n                  [\&quot;/activity-edit\&quot; {:get activity-edit-handler}]\n                  [\&quot;/activity\&quot; {:delete activity-delete-handler}]\n                  ]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 12578, :ns &quot;web.server&quot;} {:command &quot;  (ns web.server\n    (:require [ring.adapter.jetty :as jetty]\n              [reitit.ring :as ring]\n              [reitit.ring.middleware.parameters :as parameters]\n              [ring.middleware.keyword-params :refer [wrap-keyword-params]]\n              [hiccup.page :refer [html5]]\n              [hiccup2.core :as h]\n              [project.api :as api]\n              [datomic.api :as d]\n              [project.system :as sys]\n              [clojure.string :as str]\n              [ring.middleware.session :refer [wrap-session]]\n              [cheshire.core :refer :all]\n              )\n    (:import (java.time LocalDate LocalTime Duration ZoneId)\n             (java.time.format DateTimeFormatter)\n             (java.util UUID)))\n\n(def port 3000)\n(defn parse-date [date-str]\n  (if (or (empty? date-str) (= \&quot;today\&quot; date-str))\n    (LocalDate/now)\n    (try (LocalDate/parse date-str)\n         (catch Exception _ (LocalDate/now)))))\n\n(defn format-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;yyyy-MM-dd\&quot;)))\n\n(defn nice-date [date]\n  (.format date (DateTimeFormatter/ofPattern \&quot;EEEE, dd. MMMM yyyy.\&quot;)))\n\n(defn get-next-day [date]\n  (.plusDays date 1))\n(defn get-previous-day [date]\n  (.minusDays date 1))\n\n(defn insant-&gt;minutes-from-midnight [inst]\n  (let [zdt (.atZone (.toInsant inst) (project.time/zone))\n        hour (.getHour zdt)\n        minute (.getMinute zdt)\n        (+ (* hour 60) minute)]))\n\n(defn common-layout [&amp; content]\n  (html5\n   [:head\n    [:title \&quot;BeBetter\&quot;]\n    [:meta {:charset \&quot;UTF-8\&quot;}]\n    [:script {:src \&quot;https://unpkg.com/htmx.org@1.9.10\&quot;}]\n    \&quot;\&quot;\n    [:style\n     \&quot;\n        /* RESET &amp; BASE */\n        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }\n        body { background-color: #f8f9fa; color: #333; display: flex; height: 100vh; overflow: hidden; }\n\n        /* SIDEBAR */\n        .sidebar { width: 260px; background: white; border-right: 1px solid #e0e0e0; display: flex; flex-direction: column; padding: 20px; flex-shrink: 0; z-index: 50; }\n        .logo { font-size: 24px; font-weight: 800; color: #2c3e50; margin-bottom: 40px; padding-left: 10px; }\n        .nav-link { display: flex; align-items: center; padding: 12px 15px; color: #555; text-decoration: none; border-radius: 8px; margin-bottom: 5px; font-weight: 500; transition: all 0.2s; }\n        .nav-link:hover { background-color: #f0f4f8; color: #2c3e50; }\n        .nav-link span { margin-right: 12px; font-size: 1.1em; }\n\n        /* MAIN CONTENT */\n        .main-content { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; }\n        h2 { font-size: 28px; margin-bottom: 20px; color: #2c3e50; font-weight: 600; }\n\n        /* DAY SELECTOR */\n        #days-nav { display: flex; gap: 10px; margin-bottom: 20px; background: white; padding: 10px; border-radius: 12px; border: 1px solid #e0e0e0; width: fit-content; }\n        .day-column { padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; color: #777; transition: all 0.2s; border: 1px solid transparent; }\n        .day-column:hover { background-color: #f8f9fa; color: #333; }\n        .day-column.selected { background-color: #2c3e50; color: white; box-shadow: 0 4px 6px rgba(44, 62, 80, 0.2); }\n\n        /* KALENDAR GRID */\n        .calendar-wrapper { position: relative; background: white; border-radius: 12px; border: 1px solid #e0e0e0; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }\n        .calendar-scroll { height: 70vh; overflow-y: auto; position: relative; } /* Skroluje samo kalendar */\n\n        .hour-row { height: 60px; border-bottom: 1px solid #f0f0f0; position: relative; display: flex; align-items: center; }\n        .hour-label { width: 60px; text-align: right; padding-right: 15px; color: #999; font-size: 12px; font-weight: 500; user-select: none; }\n        .hour-slot { flex: 1; height: 100%; cursor: pointer; transition: background 0.1s; position: relative; border-left: 1px solid #f0f0f0; }\n        .hour-slot:hover { background-color: #fcfcfc; }\n\n        /* FORMA U SLOTU */\n        .slot-form-container { padding: 10px; background: white; border-radius: 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 1px solid #e0e0e0; z-index: 100; position: absolute; top: 5px; left: 5px; width: 300px; animation: fadeIn 0.2s; }\n        .slot-form { display: flex; gap: 8px; flex-wrap: wrap; }\n        .slot-form select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; background: #fff; flex: 1; font-size: 13px; }\n        .slot-form button { padding: 8px 15px; background: #2c3e50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 13px; }\n        .slot-form button:hover { background: #34495e; }\n\n        /* AKTIVNOST BLOK */\n        .activity-block {\n            position: absolute; left: 65px; right: 10px;\n            background: #e3f2fd; border-left: 4px solid #2196f3;\n            color: #1565c0; padding: 8px 12px; border-radius: 4px;\n            font-size: 13px; font-weight: 500;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n            cursor: pointer; transition: transform 0.1s;\n            z-index: 20; pointer-events: auto;\n            display: flex; align-items: center; justify-content: space-between;\n        }\n        .activity-block:hover { transform: scale(1.01); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }\n        .activity-actions button { background: none; border: none; cursor: pointer; color: #d32f2f; font-size: 12px; font-weight: bold; }\n\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }\n     \&quot;]]\n\n   [:body\n    [:div.sidebar\n     [:div.logo-wrapper\n      [:div.logo \&quot;BeBetter\&quot;]]\n     [:ul.sidebar-menu\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;\\uD83C\\uDFE0\&quot;] [:span \&quot;Feed\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;⚡\&quot;] [:span \&quot;Aktivnost\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🏆\&quot;] [:span \&quot;Rang Lista\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;🔍\&quot;] [:span \&quot;Pretraga\&quot;]]]\n      [:li [:a.nav-link {:href \&quot;#\&quot;} [:span \&quot;👤\&quot;] [:span \&quot;Moj Profil\&quot;]]]]]\n    [:main.main-content\n     content]]))\n\n(defn sidebar []\n  [:div.sidebar\n   [:div.logo-wrapper\n    [:span \&quot;BeBetter\&quot;]]\n   [:ul.sidebar-menu\n    [:a.nav-link\n     [:li [:span \&quot;Activity\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Feed\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Leaderboard\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;Search\&quot;]]]\n    [:a.nav-link\n     [:li [:span \&quot;My Profile\&quot;]]]]])\n\n(def days [\&quot;Mon\&quot; \&quot;Tue\&quot; \&quot;Wed\&quot; \&quot;Thu\&quot; \&quot;Fri\&quot; \&quot;Sat\&quot; \&quot;Sun\&quot;])\n\n(defn day-column [selected-day]\n  [:div {:id \&quot;days-nav\&quot;\n         :style \&quot;display: flex; gap: 1rem; margin-bottom: 20px;\&quot;}\n   (for [d days]\n     [:div.day-column\n      {:class (when (= d selected-day) \&quot;selected\&quot;)\n       :hx-post \&quot;/select-day\&quot;\n       :hx-vals (generate-string {:day d})\n       :hx-target \&quot;#calendar-view\&quot;\n       :hx-swap \&quot;outerHTML\&quot;}\n      d])])\n(defn activity-&gt;block [{:keys [id title intensity duration hour]}]\n  (let [top (* 60 hour)\n        height (* duration 60)]\n    [:div.activity-block\n     {:id id\n      :hx-get \&quot;/activity-edit\&quot;\n      :hx-target \&quot;this\&quot;\n      :hx-swap \&quot;outerHTML\&quot;\n      :hx-vals (generate-string {:id id})\n      :style (str \&quot;position:absolute;\&quot;\n                  \&quot;top:\&quot; top \&quot;px;\&quot;\n                  \&quot;left:4px;\&quot;\n                  \&quot;right:4px;\&quot;\n                  \&quot;height:\&quot; height \&quot;px;\&quot;\n                  \&quot;background:#2c3e50;\&quot;\n                  \&quot;color:white;\&quot;\n                  \&quot;border-radius:6px;\&quot;\n                  \&quot;padding:6px;\&quot;\n                  \&quot;z-index:10;\&quot;)}\n     (str title \&quot; [\&quot; intensity \&quot;]\&quot;)]))\n\n(defn calendar-view [day activities]\n  [:div#calendar-view.calendar\n   [:h3 (str \&quot;Day: \&quot; (or day \&quot;Monday\&quot;))]\n   [:div.calendar-wrapper\n    [:div.calendar-scroll\n     [:div#calendar-layer {:style \&quot;position:absolute; inset:0; pointer-events: auto; z-index: 10;\&quot;}]\n\n     (for [a activities]\n       (activity-&gt;block a))\n\n     (for [hour (range 24)]\n       [:div.hour-row\n        [:div.hour-label (str hour \&quot;:00\&quot;)]\n        [:div.hour-slot\n         {:hx-get \&quot;/slot-form\&quot;\n          :hx-vals (generate-string {:hour hour})\n          :hx-target \&quot;this\&quot;\n          :hx-swap \&quot;innerHTML\&quot;\n          :hx-trigger \&quot;click once\&quot;}]])]\n    ]])\n\n\n(defn slot-form [day-time]\n  [:div.slot-form-container {:onclick \&quot;event.stopPropagation()\&quot;}\n   [:form.slot-form\n    {:hx-post \&quot;/add-activity\&quot;\n     :hx-target \&quot;#calendar-layer\&quot;\n     :hx-swap \&quot;beforeend\&quot;\n     :style \&quot;display: flex; gap: 10px; align-items: center;\&quot;}\n   [:input {:type \&quot;hidden\&quot;\n            :name \&quot;day-time\&quot;\n            :value day-time}]\n\n    [:select {:name \&quot;title\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Activity\&quot;]\n     [:option {:value \&quot;training\&quot;} \&quot;Training\&quot;]\n     [:option {:value \&quot;study\&quot;} \&quot;Study\&quot;]\n     [:option {:value \&quot;work\&quot;} \&quot;Work\&quot;]]\n\n    [:select {:name \&quot;intensity\&quot; :required true }\n     [:option {:value \&quot;\&quot; :selected true :disabled true :hidden true} \&quot;Choose Intensity\&quot;]\n     [:option {:value \&quot;low\&quot;} \&quot;Low\&quot;]\n     [:option {:value \&quot;mid\&quot;} \&quot;Mid\&quot;]\n     [:option {:value \&quot;high\&quot;} \&quot;High\&quot;]]\n\n    [:select {:name \&quot;duration\&quot;}\n     [:option {:value \&quot;1\&quot;} \&quot;1h\&quot;]\n     [:option {:value \&quot;2\&quot;} \&quot;2h\&quot;]\n     [:option {:value \&quot;3\&quot;} \&quot;3h\&quot;]\n     [:option {:value \&quot;4\&quot;} \&quot;4h\&quot;]]\n\n   [:button {:type \&quot;submit\&quot; } \&quot;Save\&quot;]]])\n\n  (defn activity-edit-view [id]\n    [:div {:style \&quot;background:#fff; border:1px solid #ccc; padding:6px; border-radius:6px;\&quot;}\n     [:button {:hx-delete \&quot;/activity\&quot;\n               :hx-vals (generate-string {:id id})\n               :hx-target \&quot;closest .activity-block\&quot;\n               :hx-swap \&quot;outerHTML\&quot;}\n      \&quot;Delete\&quot;]])\n\n\n\n(defn home-page [{:keys [session]}]\n  (let [selected-day (:select-day session)\n        activities (get-in session [:activities selected-day] [])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body\n     (common-layout\n       [:div\n        [:h2 \&quot;Calendar\&quot;]\n        (day-column selected-day)\n        (calendar-view selected-day activities)])}))\n\n(defn select-day-handler [{:keys [params session]}]\n  (let [day (:day params)\n        activities (get-in session [:activities day])]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (assoc session :select-day day)\n     :body (str (h/html (calendar-view day activities))\n                (h/html [:div {:id \&quot;day-nav\&quot; :hx-swap-oob \&quot;true\&quot;}\n                         (h/html (day-column day))]))}))\n\n(defn slot-form-handler [{:keys [params]}]\n  (let [hour (:hour params)]\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :body (str (h/html (slot-form hour)))\n     }))\n\n(defn add-activity-handler [{:keys [params session]}]\n  (println \&quot;PARAMS:\&quot; params)\n  (let [day (:select-day session)\n        id (str (UUID/randomUUID))\n        activities {:id id\n                    :title (:title params)\n                    :duration (Integer/parseInt (:duration params))\n                    :intensity (:intensity params)\n                    :hour (Integer/parseInt (:hour params)  )}\n\n        ]\n\n    {:status 200\n     :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n     :session (update-in session [:activities day] (fnil conj []) activities)\n     :body\n     (str\n       (h/html (activity-&gt;block activities)))}))\n\n  (defn activity-edit-handler [{:keys [params]}]\n    (let [id (:id params)]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body (str (h/html (activity-edit-view id)))})\n    )\n\n  (defn activity-delete-handler [_]\n      {:status 200\n       :headers {\&quot;Content-Type\&quot; \&quot;text/html\&quot;}\n       :body \&quot;\&quot;})\n\n(def app\n  (wrap-session\n   (ring/ring-handler\n    (ring/router [[\&quot;/\&quot; {:get home-page}]\n                  [\&quot;/select-day\&quot; {:post select-day-handler}]\n                  [\&quot;/slot-form\&quot; {:get slot-form-handler}]\n                  [\&quot;/add-activity\&quot; {:post add-activity-handler}]\n                  [\&quot;/activity-edit\&quot; {:get activity-edit-handler}]\n                  [\&quot;/activity\&quot; {:delete activity-delete-handler}]\n                  ]\n                 {:data {:middleware [parameters/parameters-middleware\n                                      wrap-keyword-params]}}))))\n\n(defonce server (atom nil))\n\n(defn start-server []\n  (when-not @server\n    (reset! server (jetty/run-jetty #'app {:port port :join? false}))\n    (println \&quot;server pokrenut na http://localhost:3000\&quot;)))\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.stop s)\n    (reset! server nil)))     ; https://ericnormand.me/guide/clojure-web-tutorial\n\n(defn stop-server []\n  (when-some [s @server] ;; check if there is an object in the atom\n    (.interrupt s)\n    (reset! server nil)))&quot;, :offset 12588, :ns &quot;web.server&quot;}], :remote []}}</component>
  <component name="RunManager" selected="Clojure REPL.REPL for ProjectV1">
    <configuration default="true" type="Babashka" factoryName="BabashkaLocalRepl" activateToolWindowBeforeRun="false">
      <setting name="displayName" value="" />
      <setting name="bbPath" value="" />
      <setting name="parameters" value="" />
      <option name="PARENT_ENVS" value="true" />
      <setting name="workingDir" value="" />
      <setting name="focusEditor" value="false" />
      <method v="2">
        <option name="Make" enabled="true" />
      </method>
    </configuration>
    <configuration name="REPL for ProjectV1" type="ClojureREPL" factoryName="Local" activateToolWindowBeforeRun="false">
      <option name="configVersion" value="1" />
      <option name="displayName" value="REPL for ProjectV1" />
      <option name="execution" value="LEININGEN" />
      <module name="ProjectV1" />
      <option name="options" />
      <option name="profiles" />
      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
      <method v="2" />
    </configuration>
    <configuration default="true" type="ClojureREPL" factoryName="Local" activateToolWindowBeforeRun="false">
      <option name="configVersion" value="1" />
      <option name="options" />
      <option name="profiles" />
      <method v="2" />
    </configuration>
    <configuration default="true" type="ClojureREPL" factoryName="Remote" activateToolWindowBeforeRun="false">
      <setting name="displayName" value="" />
      <setting name="host" value="" />
      <setting name="port" value="0" />
      <setting name="replType" value="SOCKET" />
      <setting name="configType" value="SPECIFY" />
      <setting name="replPortFileType" value="STANDARD" />
      <setting name="customPortFile" value="" />
      <setting name="fixLineNumbers" value="false" />
      <setting name="useHeartbeat" value="true" />
      <setting name="focusEditor" value="false" />
      <setting name="urlFile" value="" />
      <method v="2" />
    </configuration>
    <configuration name="Test project.api-test/delta-test" type="ClojureTestRunConfiguration" factoryName="clojure.test" temporary="true">
      <module name="ProjectV1" />
      <option name="selector" value="SINGLE_VAR" />
      <option name="varFqn" value="project.api-test/delta-test" />
      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
      <method v="2" />
    </configuration>
    <configuration name="Test project.api-test/leaderboard-rank-ties-test" type="ClojureTestRunConfiguration" factoryName="clojure.test" temporary="true">
      <module name="ProjectV1" />
      <option name="selector" value="SINGLE_VAR" />
      <option name="varFqn" value="project.api-test/leaderboard-rank-ties-test" />
      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
      <method v="2" />
    </configuration>
    <recent_temporary>
      <list>
        <item itemvalue="clojure.test.Test project.api-test/delta-test" />
        <item itemvalue="clojure.test.Test project.api-test/leaderboard-rank-ties-test" />
      </list>
    </recent_temporary>
  </component>
  <component name="SharedIndexes">
    <attachedChunks>
      <set>
        <option value="bundled-jdk-9823dce3aa75-fbdcb00ec9e3-intellij.indexing.shared.core-IU-251.25410.129" />
        <option value="bundled-js-predefined-d6986cc7102b-6a121458b545-JavaScript-IU-251.25410.129" />
      </set>
    </attachedChunks>
  </component>
  <component name="TaskManager">
    <task active="true" id="Default" summary="Default task">
      <changelist id="4d338447-6f3a-43e8-ab8c-95e214f36644" name="Changes" comment="" />
      <created>1767121985479</created>
      <option name="number" value="Default" />
      <option name="presentableId" value="Default" />
      <updated>1767121985479</updated>
      <workItem from="1767121986415" duration="3674000" />
      <workItem from="1767181139032" duration="1494000" />
      <workItem from="1767351215899" duration="6476000" />
      <workItem from="1767379148928" duration="2673000" />
      <workItem from="1767381868455" duration="67000" />
      <workItem from="1767472762290" duration="1088000" />
      <workItem from="1767537145030" duration="11000" />
      <workItem from="1767625268145" duration="5102000" />
      <workItem from="1767694847080" duration="18149000" />
      <workItem from="1767804228503" duration="9080000" />
      <workItem from="1767892649731" duration="8974000" />
      <workItem from="1767906416609" duration="6067000" />
      <workItem from="1767958972899" duration="595000" />
      <workItem from="1768070963735" duration="14388000" />
      <workItem from="1768129866250" duration="9988000" />
      <workItem from="1768149678456" duration="13189000" />
      <workItem from="1768171748332" duration="36000" />
      <workItem from="1768403682096" duration="4369000" />
      <workItem from="1768474526888" duration="8177000" />
      <workItem from="1768491610839" duration="3377000" />
      <workItem from="1768587661011" duration="10613000" />
      <workItem from="1768638813832" duration="14723000" />
      <workItem from="1768662775460" duration="5330000" />
      <workItem from="1768736915225" duration="291000" />
      <workItem from="1768771507620" duration="5414000" />
      <workItem from="1768808685053" duration="10422000" />
      <workItem from="1768828344403" duration="6339000" />
      <workItem from="1768841963659" duration="9097000" />
      <workItem from="1768919011338" duration="96000" />
      <workItem from="1769022282280" duration="7836000" />
      <workItem from="1769075977686" duration="8791000" />
      <workItem from="1769089486580" duration="5158000" />
      <workItem from="1769124897316" duration="72000" />
      <workItem from="1769184242641" duration="3047000" />
      <workItem from="1769250460539" duration="3000" />
      <workItem from="1769333055758" duration="3673000" />
      <workItem from="1769361640551" duration="10655000" />
      <workItem from="1769419857978" duration="11966000" />
      <workItem from="1769452940043" duration="2856000" />
      <workItem from="1769540791944" duration="4000" />
      <workItem from="1769548779354" duration="4444000" />
      <workItem from="1769589827861" duration="3658000" />
      <workItem from="1769618988716" duration="2355000" />
      <workItem from="1769677511044" duration="15282000" />
      <workItem from="1769697916247" duration="11000" />
      <workItem from="1769710839254" duration="4017000" />
      <workItem from="1769806496931" duration="2000" />
      <workItem from="1769808410217" duration="692000" />
      <workItem from="1769851791837" duration="8006000" />
    </task>
    <task id="LOCAL-00001" summary="Ucitan je Datomic, sad vezbam koriscenje kroz dokumentaciju">
      <option name="closed" value="true" />
      <created>1767125847824</created>
      <option name="number" value="00001" />
      <option name="presentableId" value="LOCAL-00001" />
      <option name="project" value="LOCAL" />
      <updated>1767125847824</updated>
    </task>
    <task id="LOCAL-00002" summary="Dodate neke default funkcije koje rade sa bazom u datomicu">
      <option name="closed" value="true" />
      <created>1767367199446</created>
      <option name="number" value="00002" />
      <option name="presentableId" value="LOCAL-00002" />
      <option name="project" value="LOCAL" />
      <updated>1767367199446</updated>
    </task>
    <task id="LOCAL-00003" summary="Uradjene kreiraj korisnika i dodaj xp u bazi">
      <option name="closed" value="true" />
      <created>1767381886292</created>
      <option name="number" value="00003" />
      <option name="presentableId" value="LOCAL-00003" />
      <option name="project" value="LOCAL" />
      <updated>1767381886292</updated>
    </task>
    <task id="LOCAL-00004" summary="Uradjene kreiraj korisnika i dodaj xp u bazi 2">
      <option name="closed" value="true" />
      <created>1767483540530</created>
      <option name="number" value="00004" />
      <option name="presentableId" value="LOCAL-00004" />
      <option name="project" value="LOCAL" />
      <updated>1767483540530</updated>
    </task>
    <task id="LOCAL-00005" summary="Provezbana funkcija add-xp">
      <option name="closed" value="true" />
      <created>1767634382925</created>
      <option name="number" value="00005" />
      <option name="presentableId" value="LOCAL-00005" />
      <option name="project" value="LOCAL" />
      <updated>1767634382925</updated>
    </task>
    <task id="LOCAL-00006" summary="transakciona funkcija koja dodaje xp useru, kreirana sema aktivnosti/event koje user izvrsava da bi dobio xp, &#10;kreirana sema tipa aktivnosti koja ima main tip aktivnosti.&#10;odvajam kod u dva paketa db i main paket, &#10;i db.clj u dva fajla schema.clj, seed.clj gde cu imati back ako mi se nesto zezne kao na primer da ubacim dva worka...">
      <option name="closed" value="true" />
      <created>1767734960862</created>
      <option name="number" value="00006" />
      <option name="presentableId" value="LOCAL-00006" />
      <option name="project" value="LOCAL" />
      <updated>1767734960862</updated>
    </task>
    <task id="LOCAL-00007" summary="transakciona funkcija koja dodaje xp useru, kreirana sema aktivnosti/event koje user izvrsava da bi dobio xp, &#10;kreirana sema tipa aktivnosti koja ima main tip aktivnosti.&#10;odvajam kod u dva paketa db i main paket, &#10;i db.clj u dva fajla schema.clj, seed.clj gde cu imati back ako mi se nesto zezne kao na primer da ubacim dva worka...">
      <option name="closed" value="true" />
      <created>1767734966394</created>
      <option name="number" value="00007" />
      <option name="presentableId" value="LOCAL-00007" />
      <option name="project" value="LOCAL" />
      <updated>1767734966394</updated>
    </task>
    <task id="LOCAL-00008" summary="Uh, datomic je malo naporan iskreno, ali zanimljiv jer je sve kao u clojuru. Odvojio sam scheme i seed, pohvatao sam fazon sa transakcijama, i kako se sta pise">
      <option name="closed" value="true" />
      <created>1767742945250</created>
      <option name="number" value="00008" />
      <option name="presentableId" value="LOCAL-00008" />
      <option name="project" value="LOCAL" />
      <updated>1767742945250</updated>
    </task>
    <task id="LOCAL-00009" summary="Kreirana funkcija activity/add, sustina app, na osnovu parametara se izracuna xp za odredjenu aktivnost">
      <option name="closed" value="true" />
      <created>1767812289892</created>
      <option name="number" value="00009" />
      <option name="presentableId" value="LOCAL-00009" />
      <option name="project" value="LOCAL" />
      <updated>1767812289893</updated>
    </task>
    <task id="LOCAL-00010" summary="Fixed add-activity-tx,&#10;user-activities -&gt; query for finding all activities of one user">
      <option name="closed" value="true" />
      <created>1767902122657</created>
      <option name="number" value="00010" />
      <option name="presentableId" value="LOCAL-00010" />
      <option name="project" value="LOCAL" />
      <updated>1767902122657</updated>
    </task>
    <task id="LOCAL-00011" summary="Daily activities by user - list of every activity done in one day.&#10;Daily-xp - user can be put in leaderboard to compete and compare daily activities with other people.">
      <option name="closed" value="true" />
      <created>1767915212637</created>
      <option name="number" value="00011" />
      <option name="presentableId" value="LOCAL-00011" />
      <option name="project" value="LOCAL" />
      <updated>1767915212637</updated>
    </task>
    <task id="LOCAL-00012" summary="Daily, Weekly and Monthly activities and xp per user">
      <option name="closed" value="true" />
      <created>1768083937606</created>
      <option name="number" value="00012" />
      <option name="presentableId" value="LOCAL-00012" />
      <option name="project" value="LOCAL" />
      <updated>1768083937606</updated>
    </task>
    <task id="LOCAL-00013" summary="Daily, Weekly and Monthly activities and xp per user">
      <option name="closed" value="true" />
      <created>1768085174478</created>
      <option name="number" value="00013" />
      <option name="presentableId" value="LOCAL-00013" />
      <option name="project" value="LOCAL" />
      <updated>1768085174478</updated>
    </task>
    <task id="LOCAL-00014" summary="Fixing old code, erasing and moving unnecessary and outdated functions. &#10;Setting up better architecture, more readable">
      <option name="closed" value="true" />
      <created>1768162612523</created>
      <option name="number" value="00014" />
      <option name="presentableId" value="LOCAL-00014" />
      <option name="project" value="LOCAL" />
      <updated>1768162612523</updated>
    </task>
    <task id="LOCAL-00015" summary="Testing of malli validation">
      <option name="closed" value="true" />
      <created>1768165269540</created>
      <option name="number" value="00015" />
      <option name="presentableId" value="LOCAL-00015" />
      <option name="project" value="LOCAL" />
      <updated>1768165269540</updated>
    </task>
    <task id="LOCAL-00016" summary="Malli validation, validate! function">
      <option name="closed" value="true" />
      <created>1768167032069</created>
      <option name="number" value="00016" />
      <option name="presentableId" value="LOCAL-00016" />
      <option name="project" value="LOCAL" />
      <updated>1768167032069</updated>
    </task>
    <task id="LOCAL-00017" summary="Validation of transaction function add-activity and create user">
      <option name="closed" value="true" />
      <created>1768169307460</created>
      <option name="number" value="00017" />
      <option name="presentableId" value="LOCAL-00017" />
      <option name="project" value="LOCAL" />
      <updated>1768169307460</updated>
    </task>
    <task id="LOCAL-00018" summary="Leaderboard for one day, week and month">
      <option name="closed" value="true" />
      <created>1768495590013</created>
      <option name="number" value="00018" />
      <option name="presentableId" value="LOCAL-00018" />
      <option name="project" value="LOCAL" />
      <updated>1768495590013</updated>
    </task>
    <task id="LOCAL-00019" summary="Leaderboard finito">
      <option name="closed" value="true" />
      <created>1768592793347</created>
      <option name="number" value="00019" />
      <option name="presentableId" value="LOCAL-00019" />
      <option name="project" value="LOCAL" />
      <updated>1768592793347</updated>
    </task>
    <task id="LOCAL-00020" summary="Leaderboard finito 2, merged daily, weekly, monthly leaderboard function in one function, all time leaderboard is still by itself">
      <option name="closed" value="true" />
      <created>1768600694449</created>
      <option name="number" value="00020" />
      <option name="presentableId" value="LOCAL-00020" />
      <option name="project" value="LOCAL" />
      <updated>1768600694449</updated>
    </task>
    <task id="LOCAL-00021" summary="Leaderboard finito 3, i merged even all-time in default leaderboard fn, so now code is clearer and less messy. Deleted unnecessary fucntion i no longer use. Added 3 tests for 2 for adding activity and 1 for leaderboard.">
      <option name="closed" value="true" />
      <created>1768661297153</created>
      <option name="number" value="00021" />
      <option name="presentableId" value="LOCAL-00021" />
      <option name="project" value="LOCAL" />
      <updated>1768661297153</updated>
    </task>
    <task id="LOCAL-00022" summary="API preparing for frontend, did some validation">
      <option name="closed" value="true" />
      <created>1768779315145</created>
      <option name="number" value="00022" />
      <option name="presentableId" value="LOCAL-00022" />
      <option name="project" value="LOCAL" />
      <updated>1768779315145</updated>
    </task>
    <task id="LOCAL-00023" summary="Leaderboard with rank and ties in xp">
      <option name="closed" value="true" />
      <created>1768833163143</created>
      <option name="number" value="00023" />
      <option name="presentableId" value="LOCAL-00023" />
      <option name="project" value="LOCAL" />
      <updated>1768833163143</updated>
    </task>
    <task id="LOCAL-00024" summary="Leaderboard delta, calculate changes in rank">
      <option name="closed" value="true" />
      <created>1768855602635</created>
      <option name="number" value="00024" />
      <option name="presentableId" value="LOCAL-00024" />
      <option name="project" value="LOCAL" />
      <updated>1768855602635</updated>
    </task>
    <task id="LOCAL-00025" summary="Leaderboard delta still">
      <option name="closed" value="true" />
      <created>1768859643777</created>
      <option name="number" value="00025" />
      <option name="presentableId" value="LOCAL-00025" />
      <option name="project" value="LOCAL" />
      <updated>1768859643777</updated>
    </task>
    <task id="LOCAL-00026" summary="Leaderboard delta test, edge case -&gt; when new user is added, how he evaluate,&#10;I failed today, it needs fix tomorrow.">
      <option name="closed" value="true" />
      <created>1769039313571</created>
      <option name="number" value="00026" />
      <option name="presentableId" value="LOCAL-00026" />
      <option name="project" value="LOCAL" />
      <updated>1769039313571</updated>
    </task>
    <task id="LOCAL-00027" summary="Leaderboard delta test, edge case -&gt; when new user is added, how he evaluate,&#10;Fixed, problem was in test data">
      <option name="closed" value="true" />
      <created>1769078211847</created>
      <option name="number" value="00027" />
      <option name="presentableId" value="LOCAL-00027" />
      <option name="project" value="LOCAL" />
      <updated>1769078211847</updated>
    </task>
    <task id="LOCAL-00028" summary="Change to clojure.test, done 2 tests">
      <option name="closed" value="true" />
      <created>1769124957289</created>
      <option name="number" value="00028" />
      <option name="presentableId" value="LOCAL-00028" />
      <option name="project" value="LOCAL" />
      <updated>1769124957289</updated>
    </task>
    <task id="LOCAL-00029" summary="Front end using htmx with hiccup.Using ring for web server and metosin reitit for routes/ with hiccup. &#10;Server is up, and most basic leaderboard is shown.">
      <option name="closed" value="true" />
      <created>1769377318034</created>
      <option name="number" value="00029" />
      <option name="presentableId" value="LOCAL-00029" />
      <option name="project" value="LOCAL" />
      <updated>1769377318034</updated>
    </task>
    <task id="LOCAL-00030" summary="Practicing htmx basics">
      <option name="closed" value="true" />
      <created>1769433573151</created>
      <option name="number" value="00030" />
      <option name="presentableId" value="LOCAL-00030" />
      <option name="project" value="LOCAL" />
      <updated>1769433573151</updated>
    </task>
    <task id="LOCAL-00031" summary="Practicing htmx basics 2">
      <option name="closed" value="true" />
      <created>1769467170509</created>
      <option name="number" value="00031" />
      <option name="presentableId" value="LOCAL-00031" />
      <option name="project" value="LOCAL" />
      <updated>1769467170509</updated>
    </task>
    <task id="LOCAL-00032" summary="Day picker and 24h planner">
      <option name="closed" value="true" />
      <created>1769555708729</created>
      <option name="number" value="00032" />
      <option name="presentableId" value="LOCAL-00032" />
      <option name="project" value="LOCAL" />
      <updated>1769555708729</updated>
    </task>
    <task id="LOCAL-00033" summary="Formated code, instagram sidebar">
      <option name="closed" value="true" />
      <created>1769642325281</created>
      <option name="number" value="00033" />
      <option name="presentableId" value="LOCAL-00033" />
      <option name="project" value="LOCAL" />
      <updated>1769642325281</updated>
    </task>
    <task id="LOCAL-00034" summary="Select time, it does not fully work, will fix">
      <option name="closed" value="true" />
      <created>1769687989801</created>
      <option name="number" value="00034" />
      <option name="presentableId" value="LOCAL-00034" />
      <option name="project" value="LOCAL" />
      <updated>1769687989801</updated>
    </task>
    <task id="LOCAL-00035" summary="User can choose activity, intensity, duration and remove activity">
      <option name="closed" value="true" />
      <created>1769697572550</created>
      <option name="number" value="00035" />
      <option name="presentableId" value="LOCAL-00035" />
      <option name="project" value="LOCAL" />
      <updated>1769697572550</updated>
    </task>
    <option name="localTasksCounter" value="36" />
    <servers />
  </component>
  <component name="TypeScriptGeneratedFilesManager">
    <option name="version" value="3" />
  </component>
  <component name="Vcs.Log.Tabs.Properties">
    <option name="TAB_STATES">
      <map>
        <entry key="MAIN">
          <value>
            <State />
          </value>
        </entry>
      </map>
    </option>
  </component>
  <component name="VcsManagerConfiguration">
    <MESSAGE value="Fixed add-activity-tx,&#10;user-activities -&gt; query for finding all activities of one user" />
    <MESSAGE value="Daily activities by user - list of every activity done in one day.&#10;Daily-xp - user can be put in leaderboard to compete and compare daily activities with other people." />
    <MESSAGE value="Daily, Weekly and Monthly activities and xp per user" />
    <MESSAGE value="Fixing old code, erasing and moving unnecessary and outdated functions. &#10;Setting up better architecture, more readable" />
    <MESSAGE value="Testing of malli validation" />
    <MESSAGE value="Malli validation, validate! function" />
    <MESSAGE value="Validation of transaction function add-activity and create user" />
    <MESSAGE value="Leaderboard for one day, week and month" />
    <MESSAGE value="Leaderboard finito" />
    <MESSAGE value="Leaderboard finito 2, merged daily, weekly, monthly leaderboard function in one function, all time leaderboard is still by itself" />
    <MESSAGE value="Leaderboard finito 3, i merged even all-time in default leaderboard fn, so now code is clearer and less messy. Deleted unnecessary fucntion i no longer use. Added 3 tests for 2 for adding activity and 1 for leaderboard." />
    <MESSAGE value="API preparing for frontend, did some validation" />
    <MESSAGE value="Leaderboard with rank and ties in xp" />
    <MESSAGE value="Leaderboard delta, calculate changes in rank" />
    <MESSAGE value="Leaderboard delta still" />
    <MESSAGE value="Leaderboard delta test, edge case -&gt; when new user is added, how he evaluate,&#10;I failed today, it needs fix tomorrow." />
    <MESSAGE value="Leaderboard delta test, edge case -&gt; when new user is added, how he evaluate,&#10;Fixed, problem was in test data" />
    <MESSAGE value="Change to clojure.test, done 2 tests" />
    <MESSAGE value="Front end using htmx with hiccup.Using ring for web server and metosin reitit for routes/ with hiccup. &#10;Server is up, and most basic leaderboard is shown." />
    <MESSAGE value="Practicing htmx basics" />
    <MESSAGE value="Practicing htmx basics 2" />
    <MESSAGE value="Day picker and 24h planner" />
    <MESSAGE value="Formated code, instagram sidebar" />
    <MESSAGE value="Select time, it does not fully work, will fix" />
    <MESSAGE value="User can choose activity, intensity, duration and remove activity" />
    <option name="LAST_COMMIT_MESSAGE" value="User can choose activity, intensity, duration and remove activity" />
  </component>
</project>